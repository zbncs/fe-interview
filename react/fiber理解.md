# 对fiber架构的理解

why

在React15以前，React递归更新组件，js线程一直被占用，中途无法退出更新，如果组件嵌套层级过深，出现页面卡顿的现象。
所以提出了fiber架构，实现异步可中断更新。

what

fiber就是React内部定义的数据结构，是一个js对象，包含了元素的信息，更新队列。也是React新架构的虚拟dom。

how

fiber就是把任务分解成一个个的工作单元，每个工作单元的执行时间很短，每执行一个工作单元前，就会判断有没有空余时间，没有空余时间，就把控制权交给浏览器。等浏览器不忙的时候再继续执行。

所以fiber架构分为三层：

调度器：根据每个工作单元的优先级判断谁先执行，然后交给协调器。
协调器：找出变化的组件，交给渲染器。
渲染器：把需要更新的组件渲染到页面上。

## fiber对生命周期的影响

由于 render 阶段是允许暂停、终止和重启的，这就导致 render 阶段的生命周期都有可能被重复执行，故也是废弃他们的原因之一。

componentWillMount
componentWillReceiveProps
componentWillUpdate



